# WPO网站性能优化

## 目录

1. [网站性能的重要性](#a)
	* [HTTP](#a1)
2. [规则1——减少HTTP请求](#b)
 	* [图片地图](#b1)
 	* [CSS Sprites](#b2)
 	* [内联图片](#b3)
 	* [合并脚本和样式表](#b4)
3. [规则2——使用内容发布网络(CDN) ](#c)
4. [规则3——添加Expires ](#d)
5. [规则4——压缩组件](#e)
	* [文档目录结构](#e1)
6. [规则5——将CSS放在顶部](#f)
7. [规则6——将JS放在顶部](#g)
8. [规则7——避免CSS表达式](#h)
9. [规则8——使用外部的JS和CSS](#i)
10. [规则9——减少DNS查找](#j)
11. [规则10——精简JS](#k)
12. [规则11——避免重定向](#l)
13. [规则12——删除重复脚步](#m)
14. [规则13——配置ETag](#n)
15. [规则14——使Ajax可缓存](#o)
16. [结语](#end)

<a name="a"></a>
# 网站性能的重要
> 能否留住用户的第一步：取决于网站的访问速度，这是用户对网站的第一感觉。

<a name="b"></a>
# 规则1——减少HTTP请求
> 额外的HTTP请求会对性能产生巨大的影响
<a name="b1"></a>
## 图片地图

	<img src="planets.jpg" border="0" usemap="#planetmap" alt="Planets" />
	<map name="planetmap" id="planetmap">
	  <area shape="circle" coords="180,139,14" href ="venus.html" alt="Venus" />
	  <area shape="circle" coords="129,161,10" href ="mercur.html" alt="Mercury" />
	  <area shape="rect" coords="0,0,110,260" href ="sun.html" alt="Sun" />
	</map>

如果你正在导航栏或其他超链接中使用多个图片，将它们转换为图片地图是加速页面的最简单的方式。缺点：在定义图片地图上区域坐标时，如果采用手工的方式则很难完成且容易出错，而且除了矩形之外几乎无法定义其他形状。通过DHTML创建的图片地图则在IE下无法工作。

<a name="b2"></a>
## CSS Sprites
将小图片合成大图

<a name="b3"></a>
## 内联图片

<a name="b4"></a>
## 合并脚本和样式表

<a name="c"></a>
# 规则2——使用内容分发网络(CDN)
> CDN是一组分布在不同地理位置的Web服务器，其目地是通过在现有地internet中增加一层新地网络架构，将网站地内容发布到最接近用户地网络“边缘”，使用户可以就近取的所需地内容，提高用户访问网站地响应速度。

CDN的优点很明显,当然也存在着小缺点,缺点就是因为他是缓存文件,如果在网站更新了内容,部分电脑,可能不会实时的更新过来,它需要将CDN那台计算机的内容也更新了,客户的显示器上内容才是最新的,这个时间可能需要几小时,甚至半天,所以对于经常更新的网站,并不是很适合用CDN加速。

<a name="d"></a>
# 规则3——添加Expires
> 页面的第一次访问会进行很多http请求，但通过使用一个长久的expires头，使这些组件可以被缓存，这会在后续的页面浏览中避免不必要的http请求。长久的expires最常用于图片，但将其用在所有组件上，包括脚本，样式表和flash。

添加长久的Expires头可以将后续页面浏览的响应时间从600ms降低到260ms，这是在900Kbps的DSL上测试的，减少了57%。页面中的组件越多，响应时间改善的越多。理想情况，页面中的所有组件都应该具有长久的expires头，并且后续的页面浏览中只需为html文档进行一个http请求，当文档中的所有组件都是从浏览器缓冲中读取出来，响应时间减少50%或更多。

<a name="e"></a>
# 规则4——压缩组件
> 启用gzip压缩

<a name="f"></a>
# 规则5——将CSS放在顶部
> 避免两种情况：白屏和无样式内容闪烁

<a name="g"></a>
# 规则6——将JS放在底部
> 页面既可以逐步呈现，也可以提高下载的并行度。如果将JS放在顶部会阻塞整个页面（阻塞对后面内容的呈现和对后面内容的下载），导致白屏现象。

<a name="h"></a>
# 规则7——避免CSS表达式

	<style>
	body {
	    background-color: expression((new Date()).getHours()%2 ? "#B8D4FF" : "#F08A00" );
	}
	</style>

这里可以使用一个特殊的expression函数，其实这是一个javascript的函数。它可以进行根据一个表达式进行计算，动态地决定background-color的值。看起来是一个相当不错的功能，但我们可能不会想到这个表达式会运算很多次（这个具体的次数可能远远超过你的想象）

<a name="i"></a>
# 规则8——使用外部的JS和CSS
